(window.webpackJsonp=window.webpackJsonp||[]).push([[107],{399:function(t,e,a){"use strict";a.r(e);var s=a(4),r=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"你在react项目中是如何使用redux的-项目结构是如何划分的"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#你在react项目中是如何使用redux的-项目结构是如何划分的"}},[t._v("#")]),t._v(" 你在React项目中是如何使用Redux的? 项目结构是如何划分的？")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://mmbiz.qpic.cn/mmbiz_png/gH31uF9VIibQwribVpXJzdw0DHK7Kk9vXY7UVLsMS4MITkK7ibmibxiahhh4dYMwJAKsjVxLQMtJvaXZUwyYPsc2LAA/640?wx_fmt=png&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1",alt:"图片"}})]),t._v(" "),e("h2",{attrs:{id:"一、背景"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、背景"}},[t._v("#")]),t._v(" 一、背景")]),t._v(" "),e("p",[t._v("在"),e("a",{attrs:{href:"http://mp.weixin.qq.com/s?__biz=MzU1OTgxNDQ1Nw==&mid=2247488588&idx=2&sn=44a851337e9ba82201231decbb41782a&chksm=fc10d61acb675f0cc3b72c42222eda1c34c5a00e6e2a3834bcbba74adce16e9937700198fbc9&scene=21#wechat_redirect",target:"_blank",rel:"noopener noreferrer"}},[t._v("Redux介绍中"),e("OutboundLink")],1),t._v("，我们了解到"),e("code",[t._v("redux")]),t._v("是用于数据状态管理，而"),e("code",[t._v("react")]),t._v("是一个视图层面的库")]),t._v(" "),e("p",[t._v("如果将两者连接在一起，可以使用官方推荐"),e("code",[t._v("react-redux")]),t._v("库，其具有高效且灵活的特性")]),t._v(" "),e("p",[e("code",[t._v("react-redux")]),t._v("将组件分成：")]),t._v(" "),e("ul",[e("li",[t._v("容器组件：存在逻辑处理")]),t._v(" "),e("li",[t._v("UI 组件：只负责现显示和交互，内部不处理逻辑，状态由外部控制")])]),t._v(" "),e("p",[t._v("通过"),e("code",[t._v("redux")]),t._v("将整个应用状态存储到"),e("code",[t._v("store")]),t._v("中，组件可以派发"),e("code",[t._v("dispatch")]),t._v("行为"),e("code",[t._v("action")]),t._v("给"),e("code",[t._v("store")])]),t._v(" "),e("p",[t._v("其他组件通过订阅"),e("code",[t._v("store")]),t._v("中的状态"),e("code",[t._v("state")]),t._v("来更新自身的视图")]),t._v(" "),e("h2",{attrs:{id:"二、如何做"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、如何做"}},[t._v("#")]),t._v(" 二、如何做")]),t._v(" "),e("p",[t._v("使用"),e("code",[t._v("react-redux")]),t._v("分成了两大核心：")]),t._v(" "),e("ul",[e("li",[t._v("Provider")]),t._v(" "),e("li",[t._v("connection")])]),t._v(" "),e("h3",{attrs:{id:"provider"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#provider"}},[t._v("#")]),t._v(" Provider")]),t._v(" "),e("p",[t._v("在"),e("code",[t._v("redux")]),t._v("中存在一个"),e("code",[t._v("store")]),t._v("用于存储"),e("code",[t._v("state")]),t._v("，如果将这个"),e("code",[t._v("store")]),t._v("存放在顶层元素中，其他组件都被包裹在顶层元素之上")]),t._v(" "),e("p",[t._v("那么所有的组件都能够受到"),e("code",[t._v("redux")]),t._v("的控制，都能够获取到"),e("code",[t._v("redux")]),t._v("中的数据")]),t._v(" "),e("p",[t._v("使用方式如下：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("<Provider store = {store}>\n    <App />\n<Provider>\n")])])]),e("h3",{attrs:{id:"connection"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#connection"}},[t._v("#")]),t._v(" connection")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("connect`方法将`store`上的`getState`和 `dispatch`包装成组件的`props\n")])])]),e("p",[t._v("导入"),e("code",[t._v("conect")]),t._v("如下：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('import { connect } from "react-redux";\n')])])]),e("p",[t._v("用法如下：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("connect(mapStateToProps, mapDispatchToProps)(MyComponent)\n")])])]),e("p",[t._v("可以传递两个参数：")]),t._v(" "),e("ul",[e("li",[t._v("mapStateToProps")]),t._v(" "),e("li",[t._v("mapDispatchToProps")])]),t._v(" "),e("h3",{attrs:{id:"mapstatetoprops"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mapstatetoprops"}},[t._v("#")]),t._v(" mapStateToProps")]),t._v(" "),e("p",[t._v("把"),e("code",[t._v("redux")]),t._v("中的数据映射到"),e("code",[t._v("react")]),t._v("中的"),e("code",[t._v("props")]),t._v("中去")]),t._v(" "),e("p",[t._v("如下：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("const mapStateToProps = (state) => {\n    return {\n        // prop : state.xxx  | 意思是将state中的某个数据映射到props中\n        foo: state.bar\n    }\n}\n")])])]),e("p",[t._v("组件内部就能够通过"),e("code",[t._v("props")]),t._v("获取到"),e("code",[t._v("store")]),t._v("中的数据")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("class Foo extends Component {\n    constructor(props){\n        super(props);\n    }\n    render(){\n        return(\n        \t// 这样子渲染的其实就是state.bar的数据了\n            <div>this.props.foo</div>\n        )\n    }\n}\nFoo = connect()(Foo)\nexport default Foo\n")])])]),e("h3",{attrs:{id:"mapdispatchtoprops"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#mapdispatchtoprops"}},[t._v("#")]),t._v(" mapDispatchToProps")]),t._v(" "),e("p",[t._v("将"),e("code",[t._v("redux")]),t._v("中的"),e("code",[t._v("dispatch")]),t._v("映射到组件内部的"),e("code",[t._v("props")]),t._v("中")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("const mapDispatchToProps = (dispatch) => { // 默认传递参数就是dispatch\n  return {\n    onClick: () => {\n      dispatch({\n        type: 'increatment'\n      });\n    }\n  };\n}\nclass Foo extends Component {\n    constructor(props){\n        super(props);\n    }\n    render(){\n        return(\n         \n             <button onClick = {this.props.onClick}>点击increase</button>\n        )\n    }\n}\nFoo = connect()(Foo);\nexport default Foo;\n")])])]),e("h3",{attrs:{id:"小结"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[t._v("#")]),t._v(" 小结")]),t._v(" "),e("p",[t._v("整体流程图大致如下所示：")]),t._v(" "),e("p",[e("img",{attrs:{src:"data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==",alt:"图片"}})]),t._v(" "),e("h2",{attrs:{id:"三、项目结构"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、项目结构"}},[t._v("#")]),t._v(" 三、项目结构")]),t._v(" "),e("p",[t._v("可以根据项目具体情况进行选择，以下列出两种常见的组织结构")]),t._v(" "),e("h4",{attrs:{id:"按角色组织-mvc"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#按角色组织-mvc"}},[t._v("#")]),t._v(" 按角色组织（MVC）")]),t._v(" "),e("p",[t._v("角色如下：")]),t._v(" "),e("ul",[e("li",[t._v("reducers")]),t._v(" "),e("li",[t._v("actions")]),t._v(" "),e("li",[t._v("components")]),t._v(" "),e("li",[t._v("containers")])]),t._v(" "),e("p",[t._v("参考如下：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("reducers/\n  todoReducer.js\n  filterReducer.js\nactions/\n  todoAction.js\n  filterActions.js\ncomponents/\n  todoList.js\n  todoItem.js\n  filter.js\ncontainers/\n  todoListContainer.js\n  todoItemContainer.js\n  filterContainer.js\n")])])]),e("h4",{attrs:{id:"按功能组织"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#按功能组织"}},[t._v("#")]),t._v(" 按功能组织")]),t._v(" "),e("p",[t._v("使用"),e("code",[t._v("redux")]),t._v("使用功能组织项目，也就是把完成同一应用功能的代码放在一个目录下，一个应用功能包含多个角色的代码")]),t._v(" "),e("p",[e("code",[t._v("Redux")]),t._v("中，不同的角色就是"),e("code",[t._v("reducer")]),t._v("、"),e("code",[t._v("actions")]),t._v("和视图，而应用功能对应的就是用户界面的交互模块")]),t._v(" "),e("p",[t._v("参考如下：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("todoList/\n  actions.js\n  actionTypes.js\n  index.js\n  reducer.js\n  views/\n    components.js\n    containers.js\nfilter/\n  actions.js\n  actionTypes.js\n  index.js\n  reducer.js\n  views/\n    components.js\n    container.js\n")])])]),e("p",[t._v("每个功能模块对应一个目录，每个目录下包含同样的角色文件：")]),t._v(" "),e("ul",[e("li",[t._v("actionTypes.js 定义action类型")]),t._v(" "),e("li",[t._v("actions.js 定义action构造函数")]),t._v(" "),e("li",[t._v("reducer.js  定义这个功能模块如果响应actions.js定义的动作")]),t._v(" "),e("li",[t._v("views 包含功能模块中所有的React组件，包括展示组件和容器组件")]),t._v(" "),e("li",[t._v("index.js 把所有的角色导入，统一导出")])]),t._v(" "),e("p",[t._v("其中"),e("code",[t._v("index")]),t._v("模块用于导出对外的接口")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import * as actions from './actions.js';\nimport reducer from './reducer.js';\nimport view from './views/container.js';\n\nexport { actions, reducer, view };\n")])])]),e("p",[t._v("导入方法如下：")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("import { actions, reducer, view as TodoList } from './xxxx'\n")])])]),e("h2",{attrs:{id:"参考文献"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考文献"}},[t._v("#")]),t._v(" 参考文献")]),t._v(" "),e("ul",[e("li",[t._v("https://www.redux.org.cn/docs/basics/UsageWithReact.html")]),t._v(" "),e("li",[t._v("https://segmentfault.com/a/1190000010384268")])])])}),[],!1,null,null,null);e.default=r.exports}}]);